<app-header></app-header>

<bundle-menu section="subscribe"></bundle-menu>

<main *ngIf="auth.user">
    <section>
        <div class="title">
            <h1>Subscribe</h1>
        </div>
        <div class="content">
            <div>
                <div *ngIf="bundle && !auth.user.has_default_payment_method">
                    <p class="add-pm-msg">
                        Before subscribing to <b>{{bundle.name}}</b>
                        you need to set a default payment method
                    </p>
                    <a class="button" routerLink="/settings/payment-methods">
                        Go to Settings
                    </a>
                </div>
                <form
                    *ngIf="auth.user.has_default_payment_method"

                    [formGroup]="subscribeForm"

                    (submit)="subscribe($event)"
                >
                    <label>
                        Choose an option
                        <select formControlName="price" required>
                            <option *ngFor="let price of prices" value="{{price.id}}">
                                {{ format.currency(price.amount, price.currency) }} / month
                            </option>
                        </select>
                    </label>
                    <button type="submit">
                        Subscribe
                    </button>
                </form>
            </div>
        </div>
    </section>
</main>
